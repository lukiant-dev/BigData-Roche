<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
<head>
<title>10 MapReduce Tips | Cloudera Developer Blog</title>

<meta name="keywords" content="hadoop, hadoop training, cloudera, hadoop tutorial, hadoop certification, apache hadoop, hadoop download, big data, open source" />
<meta name="description" content="" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="msvalidate.01" content="8857B9071A02F989DE3F8BEE557BB584" />

<link rel="search" type="application/opensearchdescription+xml" href="/assets/opensearch.xml" title="Cloudera" />

<meta property="og:title" content="10 MapReduce Tips"/>
<meta property="og:type" content="article"/>
<meta property="og:url" content="http://blog.cloudera.com/blog/2009/05/10-mapreduce-tips/"/>
<meta property="og:site_name" content="Cloudera Developer Blog"/>


<link rel="icon" href="/wp-content/themes/solutionset/assets/favicon.ico" type="image/x-icon" /> 
<link rel="stylesheet" media="all" type="text/css" href="/wp-content/themes/solutionset/assets/css/960.css?070910" />
<link rel="stylesheet" media="all" type="text/css" href="/wp-content/themes/solutionset/assets/css/reset.css?070910" />
<link rel="stylesheet" media="all" type="text/css" href="/wp-content/themes/solutionset/assets/css/all.css?20120620" />
<link rel="stylesheet" media="all" type="text/css" href="/wp-content/themes/solutionset/assets/css/wp.css?20120620" /> 

<!--[if lt IE 7]><link rel="stylesheet" type="text/css" href="http://blog.cloudera.com/wp-content/themes/solutionset/assets/css/ie6.css?20120605" media="screen"/><![endif]-->
<!--[if lt IE 8]><link rel="stylesheet" type="text/css" href="http://blog.cloudera.com/wp-content/themes/solutionset/assets/css/ie6-7.css?20120605" media="screen"/><![endif]-->
<!--[if lt IE 9]><link rel="stylesheet" type="text/css" href="http://blog.cloudera.com/wp-content/themes/solutionset/assets/css/ie.css?20120605" media="screen"/><![endif]-->

<script type="text/javascript" src="/wp-content/themes/solutionset/assets/js/modernizr-2.6.1.min.js"></script>
<script type="text/javascript" src="/wp-content/themes/solutionset/assets/js/mootools-1.2.4-yui.js"></script>
<script type="text/javascript" src="/wp-content/themes/solutionset/assets/js/mootools-1.2.4.4-more-yui.js"></script>
<script type="text/javascript" src="/wp-content/themes/solutionset/assets/js/jquery-1.6.2.min.js"></script>
<script type="text/javascript"> jQuery.noConflict(); </script>
<script type="text/javascript" src="/wp-content/themes/solutionset/assets/js/jquery.colorbox-min.js"></script>
<script type="text/javascript" src="/wp-content/themes/solutionset/assets/js/global.js?20120605"></script>
<script type="text/javascript">var switchTo5x=true;</script>
<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
<script type="text/javascript">stLight.options({publisher: "ur-aa86c136-1042-b30d-950-dd905bb179a0", doNotHash: true, doNotCopy: true, hashAddressBar: false});</script>


<link rel="pingback" href="http://blog.cloudera.com/xmlrpc.php" />
<link rel="alternate" type="application/rss+xml" title="Cloudera Developer Blog &raquo; Feed" href="http://blog.cloudera.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Cloudera Developer Blog &raquo; Comments Feed" href="http://blog.cloudera.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Cloudera Developer Blog &raquo; 10 MapReduce Tips Comments Feed" href="http://blog.cloudera.com/blog/2009/05/10-mapreduce-tips/feed/" />
<link rel='stylesheet' id='prettify-gc-syntax-highlighter-css'  href='http://blog.cloudera.com/wp-content/plugins/prettify-gc-syntax-highlighter/prettify.css?ver=3.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='cptchStylesheet-css'  href='http://blog.cloudera.com/wp-content/plugins/captcha/css/style_wp_before_3.8.css?ver=3.3.2' type='text/css' media='all' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://blog.cloudera.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://blog.cloudera.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='5 Common Questions About Apache Hadoop' href='http://blog.cloudera.com/blog/2009/05/5-common-questions-about-hadoop/' />
<link rel='next' title='Protecting per-DataNode Metadata' href='http://blog.cloudera.com/blog/2009/05/protecting-per-datanode-metadata/' />
<meta name="generator" content="WordPress 3.3.2" />
<link rel='canonical' href='http://blog.cloudera.com/blog/2009/05/10-mapreduce-tips/' />
<link rel='shortlink' href='http://blog.cloudera.com/?p=652' />


<script type="text/javascript">
 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-2275969-16']);
 _gaq.push(['_trackPageview']);

 (function() {
   var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
 })();
</script>


</head>
<body class="single single-post postid-652 single-format-standard devcenter">
			
		
			
	<header id="site-head">
<nav class="properties">
            <div class="container">
                <ul>
                    <!--<li><a href="http://www.cloudera.com">Cloudera.com</a></li>-->
                     <!--<li><a href="http://university.cloudera.com">Cloudera University</a></li>
                   <li><a href="${config.LINK_CCP}/display/DOC/Documentation">Documentation</a></li>-->
                    <li><a id="support_home_page" href="http://cloudera.com/content/support/en/home.html" class="active">Support</a></li>
                    <li><a href="http://cloudera.com/content/dev-center/en/home.html">Developers</a></li>
                  <!--<li><a href="http://cloudera.com/content/cloudera/en/partners.html">PARTNERS</a></li>-->
                   
                </ul>
                <ul class="user">
                    <li>
                       <!--<a id="signinLink" class="hidden" href="https://clouderapkb.echolane.cs3.force.com/idp/login?app=0spQ00000004CD5">Sign In</a>-->
<a id="signinLink" class="hidden" href="https://cloudera.secure.force.com">Sign In</a>
                    </li>
                    <li><a id="registerLink" class="hidden" href="http://cloudera.com/content/support/en/user-registration.html">Register</a></li>
                    <li><a href="http://cloudera.com/content/cloudera/en/about/contact-us.html">Contact Us</a></li>
                    <li><a href="http://cloudera.com/content/support/en/downloads.html">Downloads</a></li>
                    <li>
                        <div id="dropdownAction" class="dropdown" style="display:none">
                            <a id="lnkDropdowntoogle" data-toggle="dropdown" class="dropdown-toggle" href="#">

                            </a>
                            <ul aria-labelledby="dropdownMenu" tole="menu" class="dropdown-menu">
                                <li><a href="http://cloudera.com/content/support/en/edit-user-profile.html" id="editProfileLink" tabindex="-1">Edit Profile</a></li>
                                <li class="divider"></li>
                                <li>
                                <a id="logoutLink" tabindex="-1" href="#">Logout</a>
                                </script>
                                </li>
                            </ul>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="bg-fix"></div>
        </nav>
<!--</div>-->

<div class="wrapper">
    <div class="bg-fix"></div>
    <h1 class="logo">
        <a href="http://cloudera.com/content/cloudera/en/home.html">Cloudera</a>
    </h1>

<nav class="site">
        <ul>
    <li class="">
 <a href="http://community.cloudera.com" data-link="external">Community</a>
</li>
<li class="">
 <a href="http://cloudera.com/content/support/en/documentation.html" data-link="external">Documentation</a>
</li>
 <li class="">
                    <a href="http://cloudera.com/content/support/en/downloads.html" data-link="external">Downloads</a>
   </li>
     <li class="">
                    <a href="http://university.cloudera.com" data-link="external">Training</a>
     </li>
<li class="">
                    <a href="http://blog.cloudera.com" data-link="external" class="active">Blogs</a>
                    <nav class="subnav menu"> <nav><ul>
<li><a href="http://vision.cloudera.com">Cloudera Vision</a></li>
<!--<li><a href="http://blog.cloudera.com/blog">Developer Blog</a></li>-->
</ul>
</nav> </nav>
</li>
            
        </ul>
    </nav>


    <div class="form-holder">
		
	    <form action="http://cloudera.com/content/cloudera/en/search.html" id="site-search" method="get" novalidate> 
	        <label for="q" class="visuallyhidden">Search</label> 
	        <input type="search" name="q" id="q" placeholder="Search"><i class="icon-search"></i> 
	    </form>
    </div>
    </div><!--</div>-->
        </header>
				
	<div role="main" class="main">
		<div class="wrapper">
			<section class="two-col">

	
<aside class="left-col">

				<nav>
			<ul class=" ">
			
								
							<li class="">
				<a
					href="http://www.cloudera.com/content/cloudera/en/why-cloudera/hadoop-and-big-data.html"
					title="Hadoop &amp; Big Data"
					class=""
					target="_blank"				>
					Hadoop &amp; Big Data				</a>

							</li>
			
					<li class="">
				<a
					href="http://www.cloudera.com/content/cloudera/en/why-cloudera/our-customers.html"
					title="Our Customers"
					class=""
					target="_blank"				>
					Our Customers				</a>

							</li>
			
					<li class="">
				<a
					href="http://www.cloudera.com/content/cloudera/en/why-cloudera/faqs.html"
					title="FAQs"
					class=""
					target="_blank"				>
					FAQs				</a>

							</li>
			
					<li class="current">
				<a
					href="/blog/"
					title="Blog"
					class="blog"
									>
					Blog				</a>

									<ul>
									<li class="">
				<a
					href="/blog/category/accumulo/"
					title="Accumulo (1)"
					class=""
									>
					Accumulo (1)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/avro/"
					title="Avro (16)"
					class=""
									>
					Avro (16)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/bigtop/"
					title="Bigtop (6)"
					class=""
									>
					Bigtop (6)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/books/"
					title="Books (6)"
					class=""
									>
					Books (6)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/careers/"
					title="Careers (14)"
					class=""
									>
					Careers (14)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/cdh/"
					title="CDH (127)"
					class=""
									>
					CDH (127)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/cloud-2/"
					title="Cloud (9)"
					class=""
									>
					Cloud (9)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/cloudera-life/"
					title="Cloudera Life (3)"
					class=""
									>
					Cloudera Life (3)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/cloudera-manager/"
					title="Cloudera Manager (61)"
					class=""
									>
					Cloudera Manager (61)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/community/"
					title="Community (182)"
					class=""
									>
					Community (182)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/data-collection/"
					title="Data Collection (17)"
					class=""
									>
					Data Collection (17)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/data-science/"
					title="Data Science (26)"
					class=""
									>
					Data Science (26)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/distribution/"
					title="Distribution (36)"
					class=""
									>
					Distribution (36)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/events/"
					title="Events (37)"
					class=""
									>
					Events (37)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/flume/"
					title="Flume (18)"
					class=""
									>
					Flume (18)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/general/"
					title="General (327)"
					class=""
									>
					General (327)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/guest/"
					title="Guest (77)"
					class=""
									>
					Guest (77)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/hadoop/"
					title="Hadoop (293)"
					class=""
									>
					Hadoop (293)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/hardware/"
					title="Hardware (3)"
					class=""
									>
					Hardware (3)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/hbase/"
					title="HBase (124)"
					class=""
									>
					HBase (124)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/hdfs/"
					title="HDFS (45)"
					class=""
									>
					HDFS (45)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/hive/"
					title="Hive (62)"
					class=""
									>
					Hive (62)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/how-to/"
					title="How-to (53)"
					class=""
									>
					How-to (53)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/hue/"
					title="Hue (30)"
					class=""
									>
					Hue (30)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/impala/"
					title="Impala (63)"
					class=""
									>
					Impala (63)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/kite-sdk/"
					title="Kite SDK (11)"
					class=""
									>
					Kite SDK (11)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/mahout-2/"
					title="Mahout (5)"
					class=""
									>
					Mahout (5)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/mapreduce/"
					title="MapReduce (71)"
					class=""
									>
					MapReduce (71)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/meet-the-engineer/"
					title="Meet The Engineer (18)"
					class=""
									>
					Meet The Engineer (18)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/oozie/"
					title="Oozie (25)"
					class=""
									>
					Oozie (25)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/ops/"
					title="Ops And DevOps (19)"
					class=""
									>
					Ops And DevOps (19)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/pig/"
					title="Pig (35)"
					class=""
									>
					Pig (35)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/quickstart-vm/"
					title="QuickStart VM (5)"
					class=""
									>
					QuickStart VM (5)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/search/"
					title="Search (21)"
					class=""
									>
					Search (21)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/security-2/"
					title="Security (15)"
					class=""
									>
					Security (15)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/spark/"
					title="Spark (9)"
					class=""
									>
					Spark (9)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/sqoop/"
					title="Sqoop (20)"
					class=""
									>
					Sqoop (20)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/support/"
					title="Support (4)"
					class=""
									>
					Support (4)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/testing/"
					title="Testing (8)"
					class=""
									>
					Testing (8)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/this-month-in-the-ecosystem/"
					title="This Month In The Ecosystem (8)"
					class=""
									>
					This Month In The Ecosystem (8)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/tools/"
					title="Tools (6)"
					class=""
									>
					Tools (6)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/training-2/"
					title="Training (42)"
					class=""
									>
					Training (42)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/use-case/"
					title="Use Case (59)"
					class=""
									>
					Use Case (59)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/whirr/"
					title="Whirr (6)"
					class=""
									>
					Whirr (6)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/yarn/"
					title="YARN (12)"
					class=""
									>
					YARN (12)				</a>

							</li>
			
					<li class="">
				<a
					href="/blog/category/zookeeper/"
					title="ZooKeeper (24)"
					class=""
									>
					ZooKeeper (24)				</a>

							</li>
			
					<li class="">
				<a
					href="/archive/"
					title="Archives by Month"
					class=""
									>
					Archives by Month				</a>

							</li>
			
							</ul>
							</li>
			
						
			    
			
				<div style="clear:both"></div>
			</ul>
			</nav>
			<div class="menu-special">
				<ul>
							
				
				
		
				
		
				
				
				
				

		
					</ul>
			</div>
			
</aside>


<section>
			<h1 class="heading ">10 MapReduce Tips</h1>
			
			<script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
			
			<ul class="post-info">
				<li>by <a href="http://blog.cloudera.com/blog/author/tom/" title="Posts by Tom White" rel="author">Tom White</a></li>
				<li>May 18, 2009</li>
				<li class="comment"><a href="#comments">15 comments</a></li>
				
			</ul>
			
			<div class="text-block">
				<p>This piece is based on the talk &#8220;Practical MapReduce&#8221; that I gave at <a href="http://huguk.org/2009/04/huguk-2-wrap-up.html">Hadoop User Group UK on April 14</a>.</p>
<h3>1. Use an appropriate MapReduce language</h3>
<p>There are many languages and frameworks that sit on top of MapReduce, so it&#8217;s worth thinking up-front which one to use for a particular problem. There is no one-size-fits-all language; each has different strengths and weaknesses.</p>
<ul>
<li><a href="http://hadoop.apache.org/core/docs/current/mapred_tutorial.html">Java</a>: <em>Good for</em>:  speed; control; binary data; working with existing Java or MapReduce libraries.</li>
<li><a href="http://hadoop.apache.org/core/docs/current/api/org/apache/hadoop/mapred/pipes/package-summary.html">Pipes</a>: <em>Good for</em>: working with existing C++ libraries.</li>
<li><a href="http://hadoop.apache.org/core/docs/current/streaming.html">Streaming</a>: <em>Good for</em>: writing MapReduce programs in scripting languages.</li>
<li><a href="http://www.last.fm/dumbo">Dumbo</a> (Python), <a href="http://code.google.com/p/happy/">Happy</a> (Jython), <a href="http://github.com/mrflip/wukong/tree">Wukong</a> (Ruby), <a href="http://code.google.com/p/mrtoolkit/">mrtoolkit</a> (Ruby): <em>Good for</em>: Python/Ruby programmers who want quick results, and are comfortable with the MapReduce abstraction.</li>
<li><a href="http://hadoop.apache.org/pig/">Pig</a>, <a href="http://hadoop.apache.org/hive/">Hive</a>, <a href="http://www.cascading.org/">Cascading</a>: <em>Good for</em>: higher-level abstractions; joins; nested data.</li>
</ul>
<p>While there are no hard and fast rules, in general, we recommend using <a href="http://www.cloudera.com/hadoop-training-programming-with-hadoop">pure Java</a> for large, recurring jobs, <a href="http://www.cloudera.com/hadoop-training-hive-introduction">Hive</a> for SQL style analysis and data warehousing, and <a href="http://www.cloudera.com/hadoop-training-pig-introduction">Pig</a> or <a href="http://www.cloudera.com/hadoop-training-programming-with-hadoop">Streaming</a> for ad-hoc analysis.</p>
<p><span id="more-652"></span></p>
<h3>2. Consider your input data &#8220;chunk&#8221; size</h3>
<p>Are you generating large, unbounded files, like log files? Or lots of small files, like image files? How frequently do you need to run jobs?</p>
<p>Answers to these questions determine how your store and process data using HDFS. For large unbounded files, one approach (until <a href="https://issues.apache.org/jira/browse/HADOOP-5744">HDFS appends</a> are working) is to write files in batches and merge them periodically. For lots of small files, see <a href="http://blog.cloudera.com/blog/2009/02/02/the-small-files-problem/">The Small Files Problem</a>. <a href="http://hadoop.apache.org/hbase/">HBase</a> is a good abstraction for some of these problems too, so may be worth considering.</p>
<h3>3. Use SequenceFile and MapFile containers</h3>
<p><a href="http://hadoop.apache.org/core/docs/current/api/org/apache/hadoop/io/SequenceFile.html">SequenceFiles</a> are a very useful tool. They are:</p>
<ul>
<li>Splittable. So they work well with MapReduce: each map gets an independent split to work on.</li>
<li>Compressible. By using block compression you get the benefits of compression (use less disk space, faster to read and write), while keeping the file splittable still.</li>
<li>Compact. SequenceFiles are usually used with Hadoop <a href="http://hadoop.apache.org/core/docs/current/api/org/apache/hadoop/io/Writable.html">Writable</a> objects, which have a pretty compact format.</li>
</ul>
<p>A <a href="http://hadoop.apache.org/core/docs/current/api/org/apache/hadoop/io/MapFile.html">MapFile</a> is an indexed SequenceFile, useful for if you want to do look-ups by key.</p>
<p>However, both are Java-centric, so you can&#8217;t read them with non-Java tools. The <a href="http://incubator.apache.org/thrift/">Thrift</a> and <a href="http://hadoop.apache.org/avro/">Avro</a> projects are the places to look for language-neutral container file formats. (For example, see Avro&#8217;s <a href="http://svn.apache.org/viewvc/hadoop/avro/trunk/src/java/org/apache/avro/file/DataFileWriter.java?view=co">DataFileWriter</a> although there is no MapReduce integration yet.)</p>
<h3>4. Implement the Tool interface</h3>
<p>If you are writing a Java driver, then consider implementing the <a href="http://hadoop.apache.org/core/docs/current/api/org/apache/hadoop/util/Tool.html"><code>Tool</code></a> interface to get the following options for free:</p>
<ul>
<li><code>-D</code> to pass in arbitrary properties (e.g. <code>-D mapred.reduce.tasks=7</code> sets the number of reducers to 7)</li>
<li><code>-files</code> to put files into the <a href="http://hadoop.apache.org/core/docs/current/mapred_tutorial.html#DistributedCache">distributed cache</a></li>
<li><code>-archives</code> to put archives (tar, tar.gz, zip, jar) into the distributed cache</li>
<li><code>-libjars</code> to put JAR files on the task classpath</li>
</ul>
<pre><code>public class MyJob extends Configured implements Tool {

  public int run(String[] args) throws Exception {
    JobConf job = new JobConf(getConf(), MyJob.class);
    // run job ...
  }

  public static void main(String[] args) throws Exception {
    int res = ToolRunner.run(new Configuration(),
      new MyJob(), args);
    System.exit(res);
  }
}</code></pre>
<p>By taking this step you also make your driver more testable, since you can inject arbitrary configurations using <code>Configured</code>&#8217;s <code>setConf()</code> method.</p>
<h3>5. Chain your jobs</h3>
<p>It&#8217;s often natural to split a problem into multiple MapReduce jobs. The benefits are a better decomposition of the problem into smaller, more-easily understood (and more easily tested) steps. It can also boost re-usability. Also, by using the <a href="http://hadoop.apache.org/core/docs/current/fair_scheduler.html">Fair Scheduler</a>, you can run a small job promptly, and not worry that it will be stuck in a long queue of (other people&#8217;s) jobs.</p>
<p><a href="http://hadoop.apache.org/core/docs/current/api/org/apache/hadoop/mapred/lib/ChainMapper.html"><code>ChainMapper</code></a> and <a href="http://hadoop.apache.org/core/docs/current/api/org/apache/hadoop/mapred/lib/ChainReducer.html"><code>ChainReducer</code></a> (in 0.20.0) are worth checking out too, as they allow you to use smaller units within one job, effectively allowing multiple mappers before and <em>after</em> the (single) reducer: <code>M+RM*</code>.</p>
<p>Pig and Hive do this kind of thing all the time, and it can be instructive to understand what they are doing behind the scenes by using EXPLAIN, or even by reading their source code, to make you a better MapReduce programmer. Of course, you could always use Pig or Hive in the first place&#8230;</p>
<h3>6. Favor multiple partitions</h3>
<p>We&#8217;re used to thinking that the output data is contained in one file. This is OK for small datasets, but if the output is large (more than a few tens of gigabytes, say) then it&#8217;s normally better to have a partitioned file, so you take advantage of the cluster parallelism for the reducer tasks. Conceptually, you should think of your <em>output/part-*</em> files as a single &#8220;file&#8221;: the fact it is broken up is an implementation detail. Often, the output forms the input to another MapReduce job, so it is naturally processed as a partitioned output by specifying <em>output</em> as the input path to the second job.</p>
<p>In some cases the partitioning can be exploited. <a href="http://hadoop.apache.org/core/docs/current/api/org/apache/hadoop/mapred/join/CompositeInputFormat.html"><code>CompositeInputFormat</code></a>, for example, uses the partitioning to do joins efficiently on the map-side. Another example: if your output is a MapFile, you can use <code>MapFileOutputFormat</code>&#8217;s <code>getReaders()</code> method to do lookups on the partitioned output.</p>
<p>For small outputs you can merge the partitions into a single file, either by setting the number of reducers to 1 (the default), or by using the handy <code>-getmerge</code> option on the filesystem shell:</p>
<pre><code>% hadoop fs -getmerge hdfs-output-dir local-file</code></pre>
<p>This concatenates the HDFS files <em>hdfs-output-dir/part-*</em> into a single local file.</p>
<h3>7. Report progress</h3>
<p>If your task reports no progress for 10 minutes (see the <code>mapred.task.timeout</code> property) then it will be killed by Hadoop. Most tasks don&#8217;t encounter this situation since they report progress implicitly by reading input and writing output. However, some jobs which don&#8217;t process records in this way may fall foul of this behavior and have their tasks killed. Simulations are a good example, since they do a lot of CPU-intensive processing in each map and typically only write the result at the end of the computation. They should be written in such a way as to report progress on a regular basis (more frequently than every 10 minutes). This may be achieved in a number of ways:</p>
<ul>
<li>Call <code>setStatus()</code> on <code>Reporter</code> to set a human-readable description of<br />
the task&#8217;s progress</li>
<li>Call <code>incrCounter()</code> on <code>Reporter</code> to increment a user counter</li>
<li>Call <code>progress()</code> on <code>Reporter</code> to tell Hadoop that your task is still there (and making progress)</li>
</ul>
<h3>8. Debug with status and counters</h3>
<p>Using the <code>Reporter</code>&#8217;s <code>setStatus()</code> and <code>incrCounter()</code> methods is a simple but effective way to debug your jobs. Counters are often better than printing to standard error since they are aggregated centrally, and allow you to see how many times a condition has occurred.</p>
<p>Status descriptions are shown on the web UI so you can monitor a job and keep and eye on the statuses (as long as all the tasks fit on a single page). You can send extra debugging information to standard error which you can then retrieve through the web UI (click through to the task attempt, and find the <em>stderr</em> file).</p>
<p>You can do more advanced debugging with <a href="http://hadoop.apache.org/core/docs/current/mapred_tutorial.html#Debugging">debug scripts</a>.</p>
<h3>9. Tune at the job level before the task level</h3>
<p>Before you start <a href="http://hadoop.apache.org/core/docs/current/mapred_tutorial.html#Profiling">profiling tasks</a> there are a number of job-level checks to run through:</p>
<ul>
<li> Have you set the optimal number of mappers and reducers?
<ul>
<li>The number of mappers is by default set to one per HDFS block. This is usually a good default, but see tip 2.</li>
<li>The number of reducers is best set to be the number of reduce slots in the cluster (minus a few to allow for failures). This allows the reducers to complete in a single wave.</li>
</ul>
</li>
<li>Have you set a combiner (if your algorithm allows it)?</li>
<li>Have you enabled intermediate compression? (See <code>JobConf.setCompressMapOutput()</code>, or equivalently <code>mapred.compress.map.output</code>).</li>
<li>If using custom Writables, have you provided a <a href="http://hadoop.apache.org/core/docs/current/api/org/apache/hadoop/io/RawComparator.html"><code>RawComparator</code></a>?</li>
<li>Finally, there are a number of low-level <a href="http://hadoop.apache.org/core/docs/current/mapred_tutorial.html#Shuffle%2FReduce+Parameters">MapReduce shuffle parameters</a> that you can tune to get improved performance.</li>
</ul>
<h3>10. Let someone else do the cluster administration</h3>
<p>Getting a cluster up and running can be decidely non-trivial, so use some of the free tools to get started. For example, Cloudera provides <a href="https://my.cloudera.com/">an online configuration tool</a>, <a href="http://www.cloudera.com/hadoop-rpm">RPMs</a>, and <a href="http://www.cloudera.com/hadoop-deb">Debian packages</a> to set up Hadoop on your own hardware, as well as <a href="http://www.cloudera.com/hadoop-ec2">scripts to run on Amazon EC2</a>.</p>
<p>Do you have a MapReduce tip to share? Please let us know in the comments.</p>

				<div class="social-buttons">
<span class='st_facebook_large' displayText='Facebook'></span>
<span class='st_twitter_large' displayText='Tweet'></span>
<span class='st_linkedin_large' displayText='LinkedIn'></span>
<span class='st_googleplus_large' displayText='Google +'></span>
<span class='st_email_large' displayText='Email'></span>
				</div>
			</div>

			<div class="grid_2" style="margin:0">
  <div class="comments comments-2">
    <div class="field-under">
      <h4>Filed under:</h4>
      <ul class="post-categories">
	<li><a href="http://blog.cloudera.com/blog/category/general/" title="View all posts in General" rel="category tag">General</a></li>
	<li><a href="http://blog.cloudera.com/blog/category/hadoop/" title="View all posts in Hadoop" rel="category tag">Hadoop</a></li>
	<li><a href="http://blog.cloudera.com/blog/category/mapreduce/" title="View all posts in MapReduce" rel="category tag">MapReduce</a></li></ul>  	</div>
  	
  <a name="comments"></a>
  <div class="comments-head">
    <strong>15 Responses</strong>
   
  </div>
  <ul class="comments-list">
  	<li>
		<em class="comment-date">
			<a rel="nofollow" href="http://www.awadallah.com">Amr</a> /
			May 22, 2009 / 2:26 AM		</em>
		<p>test &#8212; ignore.</p>
	</li>
</li>
	<li>
		<em class="comment-date">
			<a rel="nofollow" href="">Pallavi</a> /
			September 17, 2009 / 11:26 PM		</em>
		<p>Hi,<br />
I have one concern in using Sequence File because debugging Sequence Files are more difficult than debugging TextFiles. I was initially using Sequence Files and later shifted to Text File. Regarding performance improvement, I didn&#8217;t see much improvement though.</p>
	</li>
</li>
	<li>
		<em class="comment-date">
			<a rel="nofollow" href="http://blog.cloudera.com/blog/2009/05/10-mapreduce-tips/">MWK</a> /
			October 26, 2010 / 8:48 AM		</em>
		<p>some updated links:</p>
<p>Map Reduce Tutorial (Debugging + Profiling)<br />
<a href="http://hadoop.apache.org/mapreduce/docs/current/mapred_tutorial.html" rel="nofollow">http://hadoop.apache.org/mapreduce/docs/current/mapred_tutorial.html</a></p>
<p>Fair Scheduler Guide<br />
<a href="http://hadoop.apache.org/common/docs/current/fair_scheduler.html" rel="nofollow">http://hadoop.apache.org/common/docs/current/fair_scheduler.html</a></p>
<p>RawComperator<br />
<a href="http://hadoop.apache.org/common/docs/current/api/org/apache/hadoop/io/RawComparator.html" rel="nofollow">http://hadoop.apache.org/common/docs/current/api/org/apache/hadoop/io/RawComparator.html</a></p>
<p>CompositeInputFormat,<br />
<a href="http://hadoop.apache.org/mapreduce/docs/current/api/org/apache/hadoop/mapreduce/lib/join/CompositeInputFormat.html" rel="nofollow">http://hadoop.apache.org/mapreduce/docs/current/api/org/apache/hadoop/mapreduce/lib/join/CompositeInputFormat.html</a></p>
	</li>
</li>
	<li>
		<em class="comment-date">
			<a rel="nofollow" href="">Bulton</a> /
			November 12, 2010 / 11:52 PM		</em>
		<p>I am working on a presentation on using JS to backward enhance IE6 (and all IEs), to enable the IEs to mimick support for CSS3 <a href="http://www.testkings.com/exam/F50-522.htm" rel="nofollow">testking F50-522</a>. I hope to present at SXSW in March 2010. Either way, sign up for the RSS feed so you can be alerted when I finally post what i have been working on.Cheers.</p>
	</li>
</li>
	<li>
		<em class="comment-date">
			<a rel="nofollow" href="">Jiri</a> /
			February 04, 2011 / 4:39 PM		</em>
		<p>&#8220;I have one concern in using Sequence File because debugging Sequence Files are more difficult than debugging TextFiles. I was initially using Sequence Files and later shifted to Text File. Regarding performance improvement, I didn&#8217;t see much improvement though.&#8221;</p>
<p>1. did you run compression on sequence files vs text files? I think this is where you can see some performance shift.</p>
<p>2. was your file format static or could it change over time? I think it&#8217;s easier to manage sequence files, because of the metadata being embedded.</p>
	</li>
</li>
	<li>
		<em class="comment-date">
			<a rel="nofollow" href="">sakey</a> /
			June 28, 2011 / 2:29 AM		</em>
		<p>Please can anyone post a sample code which uses chained map-reduces.</p>
	</li>
</li>
	<li>
		<em class="comment-date">
			<a rel="nofollow" href="http://unapologetic.wordpress.com/">John Armstrong</a> /
			July 23, 2011 / 9:26 PM		</em>
		<p>In re #4, does this also allow putting files on the distributed classpath?  I&#8217;m constrained (on one project) to use CDH3b3, which has not patched MAPREDUCE-752.  I&#8217;ve been having to hand around a massive fat JAR file so that my mappers and reducers know how to do their respective things.</p>
	</li>
</li>
  </ul>
  <a name="leave-comment"></a>
  <form action="/wp-comments-post.php" method="POST">
  	<div class="comment-form">
  		<h4>Leave a comment</h4>
  		<div class="row">
  			<input type="text" value="" class="txt" name="author"/>
  			<label>Name <span>required</span></label>
  		</div>
  		<div class="row">
  			<input type="text" value="" class="txt" name="email"/>
  			<label class="published">Email <span>required</span> <em>(will not be published)</em></label>
  		</div>
  		<div class="row">
  			<input type="text" value="" class="txt" name="url"/>
  			<label>Website</label>
  		</div>
  		<div class="row">
  			<textarea rows="10" cols="30" class="area" name="comment"></textarea>
  			<label>Comment</label>
  		</div>
  		<fieldset>
  			<input type="button" value="Leave Comment" class="btn cta"/>
  		</fieldset>
  	</div>
  	<input type='hidden' name='comment_post_ID' value='652' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
  	<p class="cptch_block"><label>Prove you're human!<span class="required"> *</span></label><br />		<input type="hidden" name="cptch_result" value="sCU=" />
		<input type="hidden" name="cptch_time" value="1397910161" />
		<input type="hidden" value="Version: 2.4" />
		7 &times; <input id="cptch_input" type="text" autocomplete="off" name="cptch_number" value="" maxlength="2" size="2" aria-required="true" required="required" style="margin-bottom:0;display:inline;font-size: 12px;width: 40px;" /> =  &#102;&#111;&#114;ty n&#105;&#110;&#101;	</p>  </form>
</div></section>




<!-- Google Code for New Remarketing Pixel -->
<!-- Remarketing tags may not be associated with personally identifiable information or placed on pages related to sensitive categories. For instructions on adding this tag and more information on the above requirements, read the setup guide: google.com/ads/remarketingsetup -->
<script type="text/javascript">
/* <![CDATA[ */
var google_conversion_id = 1035979479;
var google_conversion_label = "xel9CJ-P0QMQ15X_7QM";
var google_custom_params = window.google_tag_params;
var google_remarketing_only = true;
/* ]]> */
</script>
<script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">
</script>

<noscript>
<div style="display:inline;"> <img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/1035979479/?value=0&label=xel9CJ-P0QMQ15X_7QM&guid=ON&script=0"/> </div>
</noscript>
</section>
<span class="bg-fix"></span>
</div>
</div>
<footer id="global-footer">
<div class="footerContent parbase">
<footer>
  <div class="wrapper">
    <div class="bg-fix"></div>
    <nav>
      <ul>
        <li class="section"><a href="http://www.cloudera.com/content/cloudera/en/products-and-services.html">Products</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/products/cloudera-enterprise.html">Cloudera Enterprise</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/products-and-services/cloudera-express.html">Cloudera Express</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/products-and-services/cloudera-enterprise/cloudera-manager.html">Cloudera Manager</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/products-and-services/cdh.html">CDH</a></li>
        <li><a href="http://www.cloudera.com/content/support/en/downloads.html">All Downloads</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/products-and-services/professional-services.html">Professional Services</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/training.html">Training</a></li>
      </ul>
      <ul>
        <li class="section"><a href="http://www.cloudera.com/content/cloudera/en/solutions.html">Solutions</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/solutions/enterprise-solutions.html">Enterprise Solutions</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/solutions/partner.html">Partner Solutions</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/solutions/industries.html">Industry Solutions</a></li>
      </ul>
      <ul>
        <li class="section"><a href="http://www.cloudera.com/content/cloudera/en/partners.html">Partners</a></li>
        <li class="section"><a href="http://www.cloudera.com/content/cloudera/en/resources/library.html">Resource Library</a></li>
        <li class="section"><a href="https://ccp.cloudera.com/display/SUPPORT/Get+Support">Support</a></li>
      </ul>
      <ul>
        <li class="section"><a href="http://www.cloudera.com/content/cloudera/en/about.html">About</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/about/hadoop-and-big-data.html">Hadoop &amp; Big Data</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/about/management.html">Management Team</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/about/board.html">Board</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/about/events.html">Events</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/about/press-center.html">Press Center</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/about/careers.html">Careers</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/about/contact-form.html">Contact Us</a></li>
        <li><a href="http://www.cloudera.com/content/cloudera/en/subscription-center.html">Subscription Center</a></li>
      </ul>
      <div class="locale-and-social" style="float:right">
        <div>
          <div class="locale-and-social">
            <div class="locale">
              <select onchange="this.options[this.selectedIndex].value &amp;&amp; (window.location = this.options[this.selectedIndex].value);" class="site-language">
                <option value="http://www.cloudera.com" name="English">English</option>
                <option value="http://www.cloudera.co.jp/">Japanese</option>
              </select>
            </div>
            <div class="social"><span class="follow">Follow us:</span><span class="share">Share:<i class="icon-share"></i></span>
              <ul>
                <li><a class="linkedIn" target="_blank" href="http://www.linkedin.com/company/cloudera">LinkedIn</a></li>
                <li><a class="twitter" target="_blank" href="http://twitter.com/cloudera">Twitter</a></li>
                <li><a class="facebook" target="_blank" href="http://www.facebook.com/cloudera">Facebook</a></li>
                <li><a class="youtube" target="_blank" href="http://www.youtube.com/user/clouderahadoop">YouTube</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </nav>
    <nav class="global-footer"><span class="logo"><a>Cloudera</a></span>
      <address>
      <span>Cloudera, Inc.</span> <span><a target="_blank" href="http://www.google.com/maps?q=1001+Page+Mill+Rd,+Palo+Alto,+CA+94306">1001 Page Mill Road Bldg 2</a></span> <span>Palo Alto, CA 94304</span>
      </address>
      <address>
      <span><a href="http://www.cloudera.com">www.cloudera.com</a></span> <span>US: 1-888-789-1488</span> <span>Intl: 1-650-362-0488</span>
      </address>
      <div class="copyright"><span><span class="piped">©2014 Cloudera, Inc. All rights reserved</span><span class="piped"><a href="http://www.cloudera.com/content/cloudera/en/terms-of-service.html">Terms &amp; Conditions</a></span><a href="http://www.cloudera.com/content/cloudera/en/privacy-policy.html">Privacy Policy</a></span> <span>Hadoop and the Hadoop elephant logo are trademarks of the <a target="_blank" href="http://www.apache.org/">Apache Software Foundation</a>.</span></div>
    </nav>
  </div>
</footer>
<script type='text/javascript' src='http://blog.cloudera.com/wp-content/plugins/prettify-gc-syntax-highlighter/prettify.js?ver=3.3.2'></script>
<script type='text/javascript' src='http://blog.cloudera.com/wp-content/plugins/prettify-gc-syntax-highlighter/launch.js?ver=3.3.2'></script>
<div class="modal" style="display:none">
  <div id="password-required">
    <div class="inner"> </div>
  </div>
</div>
<div class="tooltip" class="tooltip" style="display:none">
</div>
<script type="text/javascript" src="http://dnn506yrbagrg.cloudfront.net/pages/scripts/0011/2160.js"></script>
<script type="text/javascript">var _kiq = _kiq || [];</script> 
<script type="text/javascript" src="http://s3.amazonaws.com/ki.js/14646/2Sr.js" async></script>
</body></html>
